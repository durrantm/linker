<!-- Links: -->
<span id="main">
  <% tbl_width = session[:full_details] == "true" ? 1200 : 700 %>
  <table width="<%= tbl_width %>">
    <tr>
      <td colspan="6">
        <div class="nav_links">
          <%=render :partial => 'links' %>
        </div>
        <%=render :partial => 'search' %>
      </td>
    </tr>
    <tr>
      <td colspan="5">&nbsp;</td>
    </tr>
    <tr>
      <th>Group</th>
      <th>URL</th>
      <th>Ver.</th>
      <th>Date</th>
      <th>Alt Text</th>
      <th>&nbsp;</th>
    </tr>
    <% cur_group, row_bg_color = '', "111111" %><!--- row_bg_color needed in case session[:row_shading] not set -->
    <!-- Had to build address manually due to issues with link_to and url_for. Refactored this somewhat but still want to address that. -->
    <% for link in @links %>
      <!-- Moved the construct code to a helper.   Anything is better than the view! -->
      <% construct_hyperlink(link.url_address, link.alt_text) %>
      <% if link.group.group_name != cur_group -%>
        <% cur_group = link.group.group_name %>
        <% display_group = cur_group %>
        <% if session[:row_shading] == 'true' -%><!--  Set the row shading color -->
          <% row_bg_color= (row_bg_color == "111111" ? "221122" : row_bg_color == "221122" ? "331133" : "111111") -%>
        <% end -%><!-- Otherwise it's the same group name -->
      <% else %>
        <% display_group = '' %>
      <% end %>
      <tr bgcolor="#<%= row_bg_color -%>">
        <td><%= display_group %></td>
        <td>
          <span id="mainLink">
            <%=sanitize @address_url %>
          </span>
        </td>
        <td><%=link.version_number %></td>
        <td>
          <%= session[:full_details] == 'true' ? link.content_date.strftime('%m/%d/%Y') : link.content_date.to_s.gsub('00:00:00 UTC','')[0,4] if link.content_date -%><%# Just the year -%>
        </td>
        <td><%=h @new_link_alt_text -%></td>
          <td>
            <%= link_to 'Details', link, {"title" => link.alt_text} -%>
          </td>
      <!-- Moved edit and delete to details page mdd 10/27/2010 -->
      </tr>
    <% end -%>
  </table>
</span>
<br />
<span class="mainLinks"><%=render :partial => 'links' %></span>
